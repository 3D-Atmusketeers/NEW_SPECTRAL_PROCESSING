#!/usr/bin/env python
# coding: utf-8

### ----- IMPORT LIBRARIES ----- ###
import numpy as np
import matplotlib.pyplot as plt
from matplotlib import rcParams, rc
import matplotlib.colors as mcolors
import matplotlib.ticker as ticker
from mpl_toolkits.axes_grid1.inset_locator import inset_axes
import matplotlib.pyplot as plt
import pandas as pd
from scipy.interpolate import interp1d
import math
import matplotlib.pylab as pl
import grab_input_data
from matplotlib.ticker import MultipleLocator


#print ("Plotting the pressure temperature condensation curves...")
#print ()
#print ()

def plot_PTC_curves(planet_names, nlat, nlon, nlev, num_orders_of_magnitude):
    base = '../Spectral-Processing/PLANET_MODELS/'
    column_names = ['lat', 'lon', 'level', 'alt', 'pres', 'temp', 'u', 'v', 'w']
    nparams = len(column_names)

    ### ----- INPUT/OUTPUT CONTROL ----- ###
    condensation_data = 'DATA/Condensation_Ts.dat'       # condensation curves

    for ind, planet_name in enumerate(planet_names):
        plt.clf()
        print('Creating plot for', planet_name)
        fig, axes = plt.subplots(nrows=1, ncols=1, figsize=(12, 8))
        plt.subplots_adjust(wspace=0.02, hspace=0.03)

        molef = grab_input_data.get_input_data('../Spectral-Processing/GCM-OUTPUT/', planet_name, 'fort.7', 'MOLEF')

        clouds = False
        if any(i > 1e-20 for i in molef):
            clouds = True

        nucleation_lim = False
        if any(i < 1e-20 for i in molef):
            nucleation_lim = True

        df = pd.read_csv(base + planet_name + '.txt', names=column_names, delim_whitespace=True)
        df.lon = df.lon.mask(df.lon >= 180.0, df.lon - 360.0)
        max_temp = math.ceil(df['temp'].max() / 100) * 100
        min_temp = max(math.floor(df['temp'].min() / 100) * 100, 0)

        data = np.loadtxt(base + planet_name + '.txt')
        data = data.reshape(nlat, nlon, nlev, nparams)

        # plot all TP-profiles (expensive)
        for i in range(nlat):
            for j in range(nlon):
                axes.semilogy(data[i][j][:, 5], data[i][j][:, 4], alpha=1.0, color='gray', linewidth=1)

        # colormap
        cm_name = 'bamO'
        cm_file = np.loadtxt(f'ScientificColourMaps8/{cm_name}/{cm_name}.txt')
        cm_file = np.roll(cm_file, int(len(cm_file) / 2), axis=0)
        my_colors = mcolors.LinearSegmentedColormap.from_list(cm_name, cm_file)

        colors = np.linspace(0, 1, nlon)
        # set color cycle
        color_idx = nlat

        # plot colored equatorial TP-profiles
        for i in range(96):
            axes.semilogy(data[24][i][:, 5], data[24][i][:, 4],
                          '-', lw=2.0, alpha=1.0, color=my_colors(colors[color_idx]))

            color_idx += 1
            if (color_idx > 95):
                color_idx = color_idx - 96
                
        MET_X_SOLAR    = 10.0 ** grab_input_data.get_input_data('../Spectral-Processing/GCM-OUTPUT/', planet_name,"fort.7","METALLICITY")

        # plot cloud condensation curves
        if clouds:
            if (0.1  <= MET_X_SOLAR < 5.0):
                al2o3 =  [1690.51, 1694.72, 1700.551, 1707.694, 1715.872, 1724.545, 1733.048, 1741.593, 1750.45, 1759.672, 1769.316, 1779.323, 1789.557, 1799.923, 1810.322, 1820.674, 1830.914, 1841.019, 1851.073, 1861.174, 1871.418, 1881.812, 1892.312, 1902.882, 1913.503, 1924.302, 1935.507, 1946.978, 1958.25, 1968.79, 1978.382, 1987.252, 1995.68, 2003.995, 2012.612, 2022.009, 2032.487, 2043.791, 2055.401, 2066.868, 2078.179, 2089.546, 2101.105, 2112.879, 2124.909, 2138.543, 2152.32, 2165.116, 2175.892, 2184.253]
                ca2sio4 =  [1514.925, 1519.874, 1526.84, 1535.157, 1544.884, 1554.989, 1564.885, 1574.535, 1584.584, 1594.474, 1604.349, 1614.656, 1624.863, 1634.945, 1645.438, 1655.887, 1666.822, 1677.633, 1688.911, 1700.196, 1711.564, 1723.283, 1735.152, 1747.017, 1759.288, 1771.64, 1784.282, 1796.713, 1809.378, 1822.226, 1835.349, 1848.777, 1862.366, 1876.143, 1890.452, 1904.654, 1919.293, 1933.96, 1948.973, 1964.195, 1979.834, 1995.33, 2011.153, 2027.233, 2043.794, 2062.726, 2082.353, 2100.669, 2116.415, 2128.722]
                cr =  [1186.393, 1190.691, 1196.637, 1203.832, 1212.116, 1220.834, 1229.202, 1237.312, 1245.373, 1253.461, 1261.8, 1270.622, 1279.823, 1289.52, 1299.701, 1310.227, 1321.049, 1331.783, 1342.396, 1353.021, 1363.623, 1374.294, 1384.916, 1395.392, 1405.976, 1416.859, 1428.363, 1440.269, 1452.844, 1465.937, 1479.324, 1493.067, 1506.804, 1520.397, 1533.999, 1547.437, 1560.901, 1574.467, 1588.422, 1602.72, 1617.539, 1632.922, 1648.664, 1664.767, 1680.918, 1698.345, 1715.341, 1730.734, 1743.478, 1753.194]
                fe =  [1369.778, 1375.758, 1383.971, 1394.089, 1405.725, 1418.161, 1430.424, 1442.838, 1455.687, 1468.912, 1482.393, 1495.975, 1509.542, 1523.075, 1536.522, 1549.918, 1563.331, 1576.909, 1590.833, 1605.209, 1620.06, 1635.377, 1651.149, 1667.399, 1684.077, 1701.165, 1718.651, 1736.578, 1754.976, 1773.818, 1793.015, 1812.505, 1832.187, 1852.049, 1872.234, 1892.124, 1913.094, 1935.23, 1957.295, 1980.73, 2004.599, 2029.262, 2053.9, 2079.152, 2105.67, 2134.941, 2165.117, 2193.011, 2215.838, 2234.038]
                kcl =  [620.112, 622.526, 625.857, 629.946, 634.588, 639.433, 644.046, 648.521, 652.983, 657.466, 662.037, 666.752, 671.628, 676.656, 681.805, 687.05, 692.345, 697.657, 702.984, 708.361, 713.817, 719.374, 725.014, 730.723, 736.483, 742.28, 748.086, 753.881, 759.661, 765.464, 771.333, 777.331, 783.48, 789.802, 796.306, 802.988, 809.819, 816.758, 823.805, 831.006, 838.433, 846.109, 854.023, 862.136, 870.399, 879.515, 888.529, 896.712, 903.494, 908.658]
                mg2sio4 =  [1375.557, 1380.021, 1386.25, 1393.957, 1402.809, 1412.147, 1421.17, 1430.075, 1439.065, 1448.144, 1457.308, 1466.578, 1475.971, 1485.533, 1495.234, 1505.073, 1515.041, 1525.147, 1535.394, 1545.813, 1556.385, 1567.122, 1578.023, 1589.1, 1600.309, 1611.666, 1623.171, 1634.818, 1646.608, 1658.59, 1670.743, 1683.073, 1695.593, 1708.314, 1721.281, 1734.5, 1747.967, 1761.661, 1775.569, 1789.737, 1804.216, 1819.107, 1834.551, 1850.655, 1867.561, 1887.06, 1906.958, 1925.523, 1941.241, 1953.447]
                mns =  [1117.921, 1121.455, 1126.364, 1132.372, 1139.178, 1146.25, 1152.965, 1159.631, 1166.38, 1173.268, 1180.298, 1187.428, 1194.664, 1201.941, 1209.236, 1216.545, 1223.924, 1231.508, 1239.214, 1247.239, 1255.519, 1263.943, 1272.368, 1280.842, 1289.355, 1297.912, 1306.562, 1315.288, 1324.089, 1333.085, 1342.232, 1351.456, 1360.718, 1370.132, 1379.691, 1389.384, 1399.142, 1408.991, 1418.857, 1428.73, 1438.709, 1448.903, 1459.399, 1470.098, 1481.11, 1493.461, 1505.809, 1517.23, 1526.77, 1534.083]
                na2s =  [780.091, 783.188, 787.451, 792.657, 798.527, 804.6, 810.305, 815.777, 821.2, 826.638, 832.205, 837.979, 844.016, 850.308, 856.825, 863.521, 870.318, 877.173, 884.061, 890.997, 897.995, 905.053, 912.167, 919.29, 926.421, 933.59, 940.877, 948.383, 956.115, 964.078, 972.277, 980.748, 989.378, 998.256, 1007.267, 1016.406, 1025.674, 1035.081, 1044.577, 1054.127, 1063.742, 1073.443, 1083.193, 1093.105, 1103.094, 1114.356, 1125.696, 1136.223, 1145.149, 1152.113]
                ni =  [1320.903, 1326.055, 1333.238, 1342.122, 1352.302, 1363.043, 1373.467, 1383.348, 1393.013, 1402.703, 1412.471, 1422.341, 1432.51, 1443.21, 1454.651, 1466.474, 1478.934, 1491.219, 1503.686, 1516.392, 1529.172, 1541.832, 1554.555, 1567.624, 1580.881, 1594.113, 1607.848, 1621.712, 1636.004, 1650.944, 1665.966, 1681.086, 1696.724, 1713.586, 1730.663, 1747.664, 1765.226, 1782.989, 1801.318, 1819.904, 1838.572, 1857.358, 1877.201, 1897.299, 1916.613, 1937.652, 1958.762, 1977.946, 1994.264, 2006.786]
                sio2 =  [1340.013, 1344.242, 1350.143, 1357.436, 1365.799, 1374.631, 1383.183, 1391.618, 1400.101, 1408.657, 1417.259, 1425.875, 1434.495, 1443.1, 1451.697, 1460.254, 1468.764, 1477.3, 1486.002, 1494.99, 1504.332, 1514.045, 1524.088, 1534.356, 1544.736, 1555.05, 1565.217, 1575.285, 1585.407, 1595.731, 1606.32, 1617.198, 1628.412, 1639.994, 1651.976, 1664.289, 1676.926, 1689.924, 1703.31, 1717.095, 1731.283, 1745.951, 1761.232, 1777.207, 1793.96, 1813.082, 1832.474, 1850.476, 1865.656, 1877.358]
                catio3 =  [1601.37, 1605.679, 1611.878, 1619.741, 1628.97, 1638.929, 1648.815, 1658.732, 1668.75, 1678.812, 1689.02, 1699.041, 1709.2, 1719.397, 1729.603, 1739.8, 1749.96, 1759.896, 1769.706, 1779.64, 1790.163, 1801.136, 1812.637, 1824.678, 1837.203, 1850.166, 1863.18, 1876.001, 1888.737, 1901.521, 1914.396, 1927.033, 1939.747, 1952.806, 1966.166, 1979.939, 1993.987, 2008.389, 2023.103, 2038.033, 2053.04, 2067.937, 2082.917, 2097.999, 2113.085, 2129.325, 2145.154, 2159.427, 2171.174, 2180.081]
                vo =  [1368.564, 1373.377, 1380.144, 1388.754, 1398.567, 1409.202, 1419.4, 1429.398, 1439.388, 1449.485, 1459.919, 1470.367, 1481.16, 1492.267, 1503.385, 1514.468, 1525.433, 1536.354, 1547.177, 1557.984, 1569.055, 1580.219, 1591.64, 1603.412, 1615.364, 1627.414, 1639.905, 1652.463, 1665.057, 1677.717, 1690.573, 1703.516, 1716.555, 1729.951, 1743.339, 1756.745, 1770.21, 1783.715, 1797.248, 1810.885, 1824.34, 1838.024, 1852.314, 1867.072, 1881.985, 1898.838, 1915.896, 1931.733, 1945.137, 1955.561]
                zns =  [710.495, 712.638, 715.382, 718.984, 722.905, 727.223, 731.19, 735.39, 739.67, 744.114, 748.188, 752.535, 756.546, 760.708, 764.903, 769.431, 773.769, 778.396, 783.226, 788.153, 793.051, 797.691, 802.186, 806.909, 811.973, 817.205, 822.547, 828.179, 834.156, 839.964, 845.819, 851.23, 856.836, 862.449, 868.048, 873.656, 879.258, 884.632, 890.243, 895.966, 902.024, 908.396, 915.213, 922.215, 929.212, 936.786, 944.085, 950.425, 955.764, 959.688]
            elif (5.0 <= MET_X_SOLAR < 15.0):
                al2o3 =  [1793.847, 1796.725, 1804.404, 1816.022, 1830.039, 1844.913, 1859.184, 1872.394, 1886.823, 1902.104, 1916.936, 1931.316, 1946.993, 1961.781, 1977.08, 1993.23, 2008.805, 2023.762, 2039.948, 2055.79, 2072.042, 2089.898, 2107.592, 2124.689, 2142.687, 2160.609, 2178.375, 2198.119, 2217.721, 2236.435, 2255.62, 2274.924, 2292.88, 2311.937, 2330.166, 2347.03, 2364.239, 2382.733, 2400.32, 2420.796, 2441.881, 2462.458, 2483.501, 2506.392, 2528.479, 2558.213, 2591.015, 2623.469, 2654.412, 2684.302]
                ca2sio4 =  [1578.887, 1581.908, 1589.958, 1602.141, 1616.839, 1632.441, 1647.416, 1661.288, 1676.44, 1692.498, 1708.115, 1723.311, 1739.946, 1755.772, 1772.494, 1790.53, 1808.228, 1825.391, 1843.824, 1861.795, 1880.192, 1900.358, 1920.322, 1939.629, 1960.022, 1980.437, 2000.861, 2023.812, 2046.877, 2069.206, 2092.358, 2116.017, 2139.04, 2165.381, 2192.1, 2217.901, 2244.188, 2271.577, 2297.426, 2327.301, 2357.729, 2386.968, 2416.316, 2447.646, 2476.576, 2511.886, 2548.538, 2583.215, 2615.753, 2648.262]
                cr =  [1289.598, 1291.635, 1297.073, 1305.302, 1315.221, 1325.734, 1335.797, 1345.073, 1355.09, 1365.597, 1375.727, 1385.537, 1396.322, 1406.576, 1417.38, 1428.998, 1440.367, 1451.37, 1463.186, 1474.689, 1486.408, 1499.18, 1511.775, 1523.936, 1536.82, 1549.771, 1562.756, 1577.351, 1592.137, 1606.701, 1622.181, 1638.579, 1655.826, 1677.8, 1701.854, 1726.41, 1751.726, 1777.734, 1803.083, 1834.217, 1867.245, 1899.867, 1932.619, 1966.64, 1997.593, 2034.048, 2070.954, 2105.196, 2137.083, 2169.443]
                fe =  [1359.979, 1363.319, 1372.201, 1385.652, 1401.883, 1419.125, 1435.695, 1451.078, 1467.955, 1485.918, 1503.461, 1520.596, 1539.371, 1557.32, 1576.504, 1597.439, 1618.195, 1638.488, 1660.291, 1681.663, 1703.907, 1728.75, 1753.721, 1778.135, 1803.904, 1829.719, 1855.812, 1885.513, 1915.692, 1945.188, 1975.88, 2007.352, 2038.439, 2074.78, 2112.294, 2149.07, 2186.787, 2226.163, 2264.021, 2309.192, 2356.358, 2402.651, 2449.585, 2499.56, 2546.526, 2606.248, 2669.924, 2731.377, 2789.497, 2846.633]
                kcl =  [616.371, 617.636, 621.007, 626.111, 632.265, 638.794, 645.053, 650.84, 657.129, 663.764, 670.197, 676.452, 683.324, 689.881, 696.858, 704.434, 711.905, 719.171, 726.952, 734.522, 742.251, 750.694, 759.036, 767.099, 775.634, 784.205, 792.831, 802.599, 812.472, 822.068, 832.011, 842.15, 852.014, 863.29, 874.728, 885.783, 897.071, 908.872, 920.083, 933.191, 946.665, 959.714, 972.862, 986.883, 999.914, 1016.069, 1033.011, 1049.17, 1064.371, 1079.474]
                mg2sio4 =  [1434.816, 1437.589, 1444.985, 1456.177, 1469.679, 1484.011, 1497.765, 1510.504, 1524.414, 1539.151, 1553.479, 1567.42, 1582.683, 1597.203, 1612.54, 1629.077, 1645.306, 1661.056, 1677.992, 1694.536, 1711.553, 1730.309, 1748.956, 1767.039, 1786.119, 1805.2, 1824.294, 1845.755, 1867.33, 1888.227, 1909.905, 1932.074, 1953.679, 1978.438, 2003.606, 2027.979, 2052.888, 2078.937, 2103.74, 2132.809, 2162.784, 2191.951, 2221.497, 2253.185, 2283.029, 2321.175, 2361.957, 2401.434, 2438.753, 2475.441]
                mns =  [1138.599, 1140.635, 1146.066, 1154.285, 1164.199, 1174.719, 1184.812, 1194.154, 1204.344, 1215.127, 1225.596, 1235.763, 1246.881, 1257.425, 1268.474, 1280.294, 1291.817, 1302.953, 1314.951, 1326.672, 1338.696, 1351.911, 1365.011, 1377.679, 1391.029, 1404.344, 1417.571, 1432.292, 1446.978, 1461.124, 1475.8, 1490.832, 1505.448, 1522.147, 1539.071, 1555.41, 1572.071, 1589.457, 1605.92, 1625.123, 1644.761, 1663.615, 1682.382, 1702.117, 1719.887, 1740.263, 1760.487, 1778.959, 1796.038, 1813.618]
                na2s =  [798.505, 800.227, 804.817, 811.766, 820.144, 829.028, 837.541, 845.403, 853.926, 862.897, 871.579, 880.012, 889.286, 898.136, 907.539, 917.738, 927.797, 937.593, 948.119, 958.413, 969.05, 980.836, 992.604, 1004.051, 1016.129, 1028.212, 1040.346, 1054.046, 1067.868, 1081.29, 1095.213, 1109.441, 1123.323, 1139.262, 1155.485, 1171.208, 1187.272, 1204.052, 1220.02, 1238.759, 1258.06, 1276.769, 1295.589, 1315.587, 1334.082, 1356.752, 1380.344, 1402.717, 1423.719, 1444.678]
                ni =  [1302.846, 1305.727, 1313.396, 1325.005, 1339.016, 1353.898, 1368.199, 1381.475, 1396.045, 1411.555, 1426.694, 1441.459, 1457.605, 1472.982, 1489.28, 1506.916, 1524.276, 1541.162, 1559.318, 1577.075, 1595.415, 1615.722, 1635.988, 1655.698, 1676.501, 1697.318, 1718.227, 1741.835, 1765.668, 1788.843, 1812.932, 1837.626, 1861.887, 1890.031, 1918.906, 1947.069, 1975.896, 2005.983, 2034.753, 2068.773, 2104.045, 2138.453, 2173.225, 2210.25, 2244.834, 2288.209, 2334.037, 2377.995, 2419.437, 2460.428]
                sio2 =  [1362.704, 1365.088, 1371.455, 1381.085, 1392.707, 1405.044, 1416.89, 1427.868, 1439.879, 1452.624, 1465.027, 1477.093, 1490.279, 1502.796, 1515.952, 1530.069, 1543.864, 1557.217, 1571.59, 1585.628, 1600.035, 1615.872, 1631.583, 1646.792, 1662.836, 1678.871, 1694.874, 1712.798, 1730.766, 1748.13, 1766.136, 1784.549, 1802.446, 1822.872, 1843.577, 1863.596, 1884.072, 1905.539, 1926.026, 1950.093, 1974.993, 1999.331, 2024.117, 2050.843, 2076.33, 2109.813, 2146.215, 2181.882, 2215.743, 2248.733]
                catio3 =  [1660.897, 1663.954, 1672.115, 1684.466, 1699.349, 1715.113, 1730.184, 1744.049, 1758.941, 1774.484, 1789.42, 1803.873, 1819.822, 1835.041, 1851.188, 1868.677, 1885.892, 1902.614, 1920.543, 1938.001, 1955.853, 1975.396, 1994.717, 2013.376, 2033.068, 2052.752, 2072.501, 2094.856, 2117.191, 2138.354, 2159.452, 2179.701, 2196.421, 2210.068, 2220.052, 2227.41, 2235.699, 2247.399, 2261.1, 2282.689, 2309.028, 2337.518, 2366.778, 2395.883, 2422.931, 2456.523, 2491.773, 2525.42, 2557.079, 2588.518]
                vo =  [1325.753, 1328.318, 1335.133, 1345.452, 1357.915, 1371.177, 1383.959, 1395.885, 1409.131, 1423.377, 1437.403, 1451.152, 1466.134, 1480.425, 1495.696, 1512.344, 1528.785, 1544.738, 1561.712, 1578.059, 1594.338, 1611.605, 1628.289, 1644.223, 1661.275, 1678.644, 1696.438, 1717.049, 1738.222, 1759.007, 1780.476, 1802.2, 1823.241, 1847.144, 1871.256, 1894.441, 1918.045, 1942.672, 1965.868, 1992.59, 2019.729, 2045.734, 2071.789, 2099.585, 2125.152, 2156.066, 2187.947, 2217.964, 2246.073, 2274.271]
                zns =  [696.332, 697.452, 700.455, 704.992, 710.465, 716.265, 721.821, 726.947, 732.494, 738.322, 743.951, 749.408, 755.402, 761.102, 767.11, 773.574, 779.904, 786.038, 792.636, 799.075, 805.686, 812.956, 820.164, 827.132, 834.465, 841.765, 848.984, 856.973, 864.906, 872.517, 880.41, 888.494, 896.325, 905.222, 914.198, 922.832, 931.629, 940.814, 949.482, 959.501, 969.703, 979.504, 989.335, 999.822, 1009.49, 1021.25, 1033.42, 1044.921, 1055.688, 1066.487]
            elif (15.0 <= MET_X_SOLAR < 50.0):
                al2o3 =  [1900.965, 1904.403, 1913.326, 1925.906, 1940.594, 1956.196, 1971.961, 1987.714, 2003.79, 2020.201, 2036.869, 2053.747, 2070.846, 2088.062, 2105.425, 2122.931, 2140.457, 2158.049, 2175.904, 2194.107, 2212.799, 2232.048, 2251.669, 2271.566, 2291.825, 2312.459, 2333.537, 2355.133, 2377.025, 2399.025, 2421.169, 2443.489, 2466.097, 2489.319, 2513.37, 2538.611, 2565.689, 2594.995, 2626.307, 2658.954, 2691.448, 2722.115, 2749.908, 2774.42, 2796.023, 2815.818, 2834.279, 2851.268, 2866.565, 2879.943]
                ca2sio4 =  [1665.649, 1669.128, 1678.41, 1691.634, 1707.172, 1723.749, 1740.551, 1757.368, 1774.519, 1791.992, 1809.698, 1827.63, 1845.893, 1864.492, 1883.558, 1903.138, 1923.086, 1943.387, 1964.167, 1985.44, 2007.305, 2029.808, 2052.731, 2075.958, 2099.581, 2123.644, 2148.29, 2173.685, 2199.655, 2226.05, 2252.954, 2280.421, 2308.56, 2337.566, 2367.197, 2397.216, 2427.785, 2459.203, 2491.891, 2526.496, 2563.073, 2601.312, 2640.798, 2680.703, 2719.863, 2757.282, 2791.357, 2820.521, 2844.208, 2862.722]
                cr =  [1365.892, 1367.841, 1373.879, 1382.578, 1392.812, 1403.733, 1414.797, 1425.854, 1437.103, 1448.534, 1460.087, 1471.746, 1483.567, 1495.532, 1507.708, 1520.119, 1532.677, 1545.391, 1558.351, 1571.564, 1585.082, 1598.938, 1613.015, 1627.269, 1641.785, 1656.611, 1671.84, 1687.581, 1703.753, 1720.325, 1737.479, 1755.468, 1774.689, 1795.508, 1817.68, 1840.73, 1864.428, 1888.78, 1914.175, 1941.344, 1970.538, 2001.888, 2035.845, 2072.825, 2113.086, 2156.666, 2201.684, 2245.256, 2285.32, 2321.209]
                fe =  [1407.446, 1411.683, 1421.583, 1435.544, 1451.982, 1469.59, 1487.499, 1505.465, 1523.822, 1542.571, 1561.65, 1581.101, 1601.085, 1621.653, 1642.992, 1665.159, 1687.947, 1711.281, 1735.262, 1759.93, 1785.48, 1812.039, 1839.38, 1867.369, 1896.112, 1925.691, 1956.348, 1988.336, 2021.432, 2055.424, 2090.431, 2126.607, 2164.265, 2203.816, 2245.003, 2287.485, 2331.423, 2377.21, 2425.577, 2477.559, 2533.016, 2590.941, 2649.888, 2707.988, 2763.778, 2816.693, 2865.097, 2907.171, 2942.382, 2970.772]
                kcl =  [634.836, 636.235, 639.892, 645.094, 651.201, 657.708, 664.292, 670.87, 677.58, 684.428, 691.394, 698.492, 705.767, 713.21, 720.858, 728.715, 736.704, 744.807, 753.07, 761.504, 770.164, 779.081, 788.177, 797.415, 806.847, 816.503, 826.46, 836.79, 847.399, 858.198, 869.215, 880.48, 892.061, 904.06, 916.391, 928.952, 941.775, 954.899, 968.383, 982.387, 996.843, 1011.637, 1026.829, 1042.547, 1058.988, 1076.381, 1094.182, 1111.452, 1127.641, 1142.84]
                mg2sio4 =  [1515.139, 1518.098, 1526.614, 1538.803, 1553.121, 1568.391, 1583.865, 1599.336, 1615.094, 1631.141, 1647.425, 1663.959, 1680.846, 1698.095, 1715.812, 1734.019, 1752.553, 1771.377, 1790.592, 1810.227, 1830.414, 1851.239, 1872.534, 1894.2, 1916.314, 1938.913, 1962.139, 1986.155, 2010.807, 2035.965, 2061.724, 2088.169, 2115.444, 2143.761, 2172.89, 2202.563, 2232.84, 2263.857, 2295.826, 2329.155, 2363.713, 2399.249, 2435.91, 2474.006, 2514.014, 2556.48, 2600.093, 2642.635, 2682.975, 2721.958]
                mns =  [1189.149, 1191.877, 1198.598, 1208.01, 1218.985, 1230.637, 1242.391, 1254.084, 1265.919, 1277.881, 1289.924, 1302.062, 1314.374, 1326.851, 1339.552, 1352.483, 1365.532, 1378.686, 1392.034, 1405.603, 1419.478, 1433.719, 1448.229, 1462.998, 1478.181, 1493.938, 1510.517, 1528.181, 1546.885, 1566.325, 1585.94, 1604.847, 1622.138, 1637.198, 1649.68, 1659.874, 1668.932, 1678.402, 1689.807, 1704.35, 1722.242, 1743.087, 1766.415, 1791.747, 1818.762, 1847.334, 1876.448, 1904.681, 1931.402, 1957.449]
                na2s =  [835.576, 837.486, 842.558, 849.815, 858.384, 867.565, 876.894, 886.227, 895.717, 905.351, 915.098, 924.986, 935.095, 945.436, 956.08, 967.051, 978.257, 989.681, 1001.387, 1013.397, 1025.797, 1038.64, 1051.811, 1065.248, 1079.003, 1093.11, 1107.659, 1122.748, 1138.257, 1154.081, 1170.261, 1186.842, 1203.924, 1221.663, 1239.946, 1258.626, 1277.747, 1297.372, 1317.59, 1338.587, 1360.176, 1382.081, 1404.283, 1426.873, 1450.05, 1474.11, 1498.386, 1521.759, 1543.705, 1564.65]
                ni =  [1343.641, 1346.865, 1355.269, 1367.233, 1381.308, 1396.347, 1411.613, 1426.918, 1442.574, 1458.593, 1474.911, 1491.533, 1508.557, 1525.979, 1543.912, 1562.377, 1581.201, 1600.343, 1619.915, 1639.952, 1660.606, 1681.987, 1703.934, 1726.357, 1749.35, 1772.954, 1797.323, 1822.627, 1848.672, 1875.292, 1902.579, 1930.643, 1959.704, 1990.058, 2021.485, 2053.699, 2086.772, 2120.858, 2156.215, 2193.308, 2231.926, 2271.706, 2312.783, 2355.526, 2400.523, 2448.431, 2497.721, 2545.652, 2590.347, 2631.385]
                sio2 =  [1431.943, 1433.934, 1441.0, 1451.327, 1463.52, 1476.537, 1489.713, 1502.869, 1516.252, 1529.865, 1543.658, 1557.654, 1571.951, 1586.551, 1601.539, 1616.915, 1632.52, 1648.316, 1664.386, 1680.75, 1697.512, 1714.751, 1732.346, 1750.244, 1768.529, 1787.233, 1806.453, 1826.298, 1846.602, 1867.224, 1888.232, 1909.696, 1931.739, 1954.537, 1977.899, 2001.618, 2025.766, 2050.467, 2075.882, 2102.338, 2129.741, 2157.924, 2187.076, 2217.564, 2249.987, 2285.026, 2321.651, 2357.943, 2392.88, 2427.24]
                catio3 =  [1733.44, 1737.232, 1746.591, 1759.779, 1775.208, 1791.608, 1808.156, 1824.668, 1841.643, 1859.507, 1878.744, 1899.736, 1922.56, 1946.811, 1971.972, 1997.374, 2021.914, 2043.755, 2060.545, 2070.89, 2075.543, 2076.574, 2076.32, 2077.335, 2082.209, 2092.886, 2110.071, 2132.532, 2157.541, 2183.053, 2208.372, 2233.062, 2256.596, 2278.753, 2299.69, 2320.13, 2341.357, 2364.821, 2392.003, 2424.252, 2461.648, 2503.234, 2547.726, 2593.555, 2638.567, 2680.519, 2717.084, 2746.86, 2770.239, 2789.211]
                vo =  [1346.645, 1349.366, 1356.633, 1367.008, 1379.225, 1392.294, 1405.592, 1418.972, 1432.718, 1446.823, 1461.195, 1475.81, 1490.739, 1505.994, 1521.715, 1537.944, 1554.501, 1571.295, 1588.341, 1605.569, 1623.009, 1640.7, 1658.53, 1676.533, 1694.939, 1713.908, 1733.636, 1754.286, 1775.652, 1797.524, 1819.938, 1842.974, 1866.824, 1891.768, 1917.681, 1944.379, 1971.922, 2000.34, 2029.658, 2060.072, 2091.326, 2123.078, 2155.357, 2188.289, 2222.027, 2256.794, 2291.466, 2324.252, 2354.041, 2380.72]
                zns =  [726.669, 727.281, 730.433, 735.157, 740.759, 746.735, 752.774, 758.787, 764.885, 771.079, 777.356, 783.732, 790.248, 796.893, 803.691, 810.63, 817.636, 824.698, 831.864, 839.161, 846.653, 854.385, 862.295, 870.344, 878.551, 886.913, 895.46, 904.238, 913.189, 922.274, 931.533, 940.99, 950.691, 960.713, 970.976, 981.373, 991.905, 1002.581, 1013.431, 1024.556, 1035.903, 1047.453, 1059.412, 1072.072, 1085.715, 1100.541, 1116.033, 1131.259, 1145.541, 1158.861]            
            elif (50.0 <= MET_X_SOLAR < 150.0):
                al2o3 =  [2015.396, 2024.867, 2037.947, 2053.505, 2071.329, 2089.609, 2107.211, 2124.495, 2142.764, 2160.859, 2179.998, 2199.137, 2218.919, 2238.39, 2258.387, 2278.191, 2298.43, 2318.592, 2339.257, 2360.156, 2381.804, 2403.908, 2426.434, 2449.377, 2472.781, 2496.81, 2521.159, 2546.129, 2571.251, 2597.063, 2622.901, 2649.548, 2676.12, 2703.619, 2730.938, 2759.156, 2787.518, 2819.347, 2852.073, 2886.935, 2920.118, 2949.667, 2973.034, 2989.913, 2999.258, 3002.765, 3001.943, 3000.877, 2999.007, 2998.993]
                ca2sio4 =  [1765.53, 1775.32, 1789.012, 1805.419, 1824.284, 1843.704, 1862.528, 1881.074, 1900.675, 1920.11, 1940.485, 1960.734, 1981.862, 2002.922, 2024.806, 2046.783, 2069.578, 2092.626, 2116.544, 2140.917, 2166.084, 2191.787, 2218.065, 2244.816, 2271.984, 2299.72, 2327.759, 2356.559, 2385.663, 2415.764, 2446.102, 2477.571, 2509.04, 2541.662, 2574.054, 2607.587, 2640.693, 2675.196, 2709.162, 2744.634, 2779.493, 2817.368, 2854.573, 2892.2, 2926.156, 2955.22, 2976.943, 2992.121, 2999.782, 3002.659]
                cr =  [1446.914, 1453.505, 1462.724, 1473.76, 1486.446, 1499.499, 1512.11, 1524.454, 1537.423, 1550.291, 1563.865, 1577.373, 1591.447, 1605.453, 1619.914, 1634.294, 1649.077, 1663.935, 1679.305, 1694.903, 1710.923, 1727.187, 1743.8, 1760.728, 1777.949, 1795.625, 1813.604, 1832.14, 1850.901, 1870.3, 1889.813, 1910.031, 1930.324, 1951.553, 1972.768, 1994.706, 2016.346, 2038.867, 2061.099, 2083.929, 2106.918, 2133.77, 2163.185, 2199.278, 2238.951, 2288.761, 2341.741, 2392.948, 2436.733, 2470.425]
                fe =  [1458.225, 1467.779, 1481.279, 1497.582, 1516.486, 1536.106, 1555.324, 1574.369, 1594.414, 1614.262, 1635.142, 1656.07, 1678.147, 1700.418, 1723.838, 1747.64, 1772.557, 1797.939, 1824.315, 1851.295, 1879.319, 1908.131, 1937.908, 1968.695, 2000.428, 2033.32, 2067.092, 2102.342, 2138.501, 2176.46, 2215.291, 2256.253, 2298.08, 2342.402, 2387.471, 2435.465, 2484.259, 2536.583, 2589.831, 2648.428, 2707.993, 2773.229, 2836.482, 2893.726, 2939.946, 2974.59, 2995.433, 3005.66, 3006.104, 3003.706]
                kcl =  [653.809, 657.406, 662.437, 668.463, 675.364, 682.441, 689.268, 695.987, 703.105, 710.176, 717.652, 725.173, 733.103, 741.058, 749.31, 757.571, 766.093, 774.665, 783.505, 792.484, 801.78, 811.299, 821.075, 831.095, 841.321, 851.81, 862.502, 873.611, 884.895, 896.547, 908.319, 920.64, 933.102, 946.178, 959.34, 973.242, 987.244, 1002.033, 1016.74, 1032.244, 1047.697, 1064.283, 1080.85, 1098.632, 1116.36, 1137.157, 1158.206, 1178.101, 1194.859, 1208.199]
                mg2sio4 =  [1605.879, 1614.989, 1627.624, 1642.701, 1660.079, 1678.019, 1695.481, 1712.713, 1730.817, 1748.727, 1767.603, 1786.405, 1806.048, 1825.757, 1846.344, 1867.062, 1888.573, 1910.294, 1932.708, 1955.484, 1978.987, 2003.016, 2027.763, 2053.18, 2079.149, 2105.841, 2133.029, 2161.17, 2189.842, 2219.755, 2250.15, 2281.992, 2314.246, 2348.168, 2382.306, 2418.077, 2453.85, 2491.634, 2529.41, 2569.526, 2609.596, 2652.547, 2695.463, 2741.638, 2787.465, 2840.185, 2892.989, 2942.628, 2984.089, 3016.856]
                mns =  [1240.618, 1247.813, 1257.874, 1269.927, 1283.755, 1297.947, 1311.646, 1325.087, 1339.148, 1352.89, 1367.15, 1381.229, 1395.882, 1410.418, 1425.434, 1440.394, 1455.794, 1471.176, 1486.923, 1502.816, 1519.106, 1535.58, 1552.39, 1569.558, 1587.064, 1605.029, 1623.221, 1641.879, 1661.059, 1681.696, 1702.225, 1721.993, 1739.294, 1752.768, 1762.245, 1768.401, 1772.619, 1778.695, 1787.913, 1803.621, 1824.078, 1850.577, 1880.073, 1912.921, 1946.912, 1987.173, 2029.24, 2069.897, 2104.96, 2133.258]
                na2s =  [875.816, 880.853, 888.01, 896.677, 906.732, 917.167, 927.375, 937.469, 948.06, 958.504, 969.457, 980.419, 991.949, 1003.506, 1015.546, 1027.663, 1040.278, 1053.085, 1066.346, 1079.864, 1093.898, 1108.298, 1123.104, 1138.309, 1153.893, 1169.994, 1186.478, 1203.581, 1221.005, 1239.19, 1257.671, 1277.009, 1296.586, 1317.166, 1337.942, 1359.9, 1381.968, 1405.324, 1428.669, 1453.335, 1477.714, 1503.335, 1528.38, 1554.519, 1579.81, 1608.218, 1636.123, 1662.113, 1683.57, 1700.519]
                ni =  [1387.193, 1395.426, 1406.972, 1420.832, 1436.784, 1453.228, 1469.207, 1484.951, 1501.534, 1518.001, 1535.396, 1552.819, 1571.157, 1589.609, 1608.89, 1628.337, 1648.529, 1668.94, 1690.05, 1711.517, 1733.676, 1756.352, 1779.777, 1804.009, 1828.957, 1854.751, 1881.144, 1908.573, 1936.579, 1965.839, 1995.593, 2026.76, 2058.428, 2091.888, 2125.735, 2161.506, 2197.61, 2236.068, 2274.843, 2316.353, 2358.066, 2402.807, 2447.699, 2496.328, 2545.128, 2602.729, 2661.463, 2717.335, 2764.708, 2802.56]
                sio2 =  [1512.783, 1520.334, 1530.939, 1543.685, 1558.45, 1573.735, 1588.564, 1603.131, 1618.399, 1633.424, 1649.125, 1664.73, 1681.066, 1697.434, 1714.586, 1731.881, 1749.775, 1767.785, 1786.311, 1805.04, 1824.274, 1843.822, 1863.86, 1884.439, 1905.507, 1927.16, 1949.223, 1972.091, 1995.307, 2019.324, 2043.542, 2068.755, 2094.219, 2120.984, 2147.822, 2175.801, 2203.733, 2233.22, 2262.603, 2293.692, 2324.702, 2357.963, 2391.266, 2427.092, 2462.748, 2504.636, 2547.231, 2587.752, 2622.042, 2649.471]
                catio3 =  [1809.311, 1818.823, 1832.127, 1848.077, 1866.423, 1885.316, 1903.669, 1921.773, 1940.849, 1959.699, 1979.415, 1998.989, 2019.461, 2039.926, 2061.171, 2082.456, 2107.622, 2136.238, 2157.753, 2164.85, 2161.778, 2152.324, 2140.784, 2131.262, 2128.0, 2135.502, 2157.771, 2191.522, 2224.368, 2254.326, 2284.783, 2316.623, 2348.765, 2382.46, 2416.405, 2452.095, 2487.857, 2525.639, 2563.358, 2603.332, 2643.17, 2685.591, 2727.94, 2778.027, 2828.509, 2872.365, 2906.082, 2929.883, 2942.165, 2945.745]
                vo =  [1366.375, 1373.408, 1383.227, 1394.981, 1408.475, 1422.36, 1435.882, 1449.258, 1463.346, 1477.272, 1491.885, 1506.416, 1521.562, 1536.65, 1552.318, 1568.074, 1584.466, 1601.018, 1618.068, 1635.336, 1653.127, 1671.281, 1689.85, 1708.789, 1728.121, 1748.0, 1768.223, 1789.105, 1810.229, 1832.001, 1854.076, 1877.378, 1901.196, 1926.602, 1952.689, 1980.811, 2009.563, 2040.328, 2071.238, 2103.959, 2136.583, 2171.196, 2205.421, 2241.875, 2277.802, 2318.674, 2359.199, 2397.022, 2428.416, 2453.156]
                zns =  [765.566, 769.002, 773.79, 779.517, 786.138, 792.984, 799.621, 806.131, 812.941, 819.67, 826.791, 833.911, 841.362, 848.827, 856.58, 864.296, 872.177, 880.016, 888.018, 896.077, 904.386, 912.888, 921.666, 930.707, 939.967, 949.509, 959.222, 969.232, 979.405, 990.033, 1000.804, 1011.976, 1023.237, 1035.109, 1047.087, 1059.68, 1072.243, 1085.381, 1098.437, 1112.259, 1125.886, 1140.131, 1154.12, 1168.925, 1183.43, 1200.17, 1216.931, 1232.704, 1245.968, 1256.597]
            elif (150.0  <= MET_X_SOLAR):
                al2o3 =  [2111.441, 2122.378, 2137.581, 2155.697, 2176.526, 2197.931, 2218.556, 2238.731, 2259.812, 2280.459, 2301.934, 2323.073, 2344.991, 2366.781, 2389.488, 2412.288, 2435.916, 2459.73, 2484.316, 2509.267, 2534.916, 2560.981, 2587.596, 2614.686, 2642.157, 2670.146, 2698.375, 2727.298, 2756.518, 2786.767, 2817.643, 2850.906, 2884.037, 2916.276, 2944.833, 2968.277, 2985.261, 2996.107, 3000.954, 3001.916, 3000.59, 2999.918, 2999.007, 2998.999, 2999.002, 2999.004, 2998.996, 2999.012, 2998.983, 2999.017]
                ca2sio4 =  [1863.385, 1874.403, 1889.789, 1908.181, 1929.337, 1951.119, 1972.249, 1993.055, 2014.928, 2036.575, 2059.464, 2082.404, 2106.53, 2130.784, 2156.018, 2181.292, 2207.431, 2233.747, 2260.741, 2287.961, 2315.917, 2344.347, 2373.473, 2403.242, 2433.515, 2464.512, 2495.983, 2528.344, 2560.932, 2594.439, 2627.944, 2662.386, 2696.634, 2731.978, 2767.088, 2804.049, 2840.6, 2878.624, 2914.204, 2945.474, 2969.986, 2987.769, 2998.013, 3002.699, 3002.584, 3001.226, 2999.006, 2999.006, 2998.987, 2999.017]
                cr =  [1529.007, 1536.829, 1547.997, 1561.43, 1576.55, 1591.76, 1606.077, 1619.805, 1634.021, 1647.888, 1662.484, 1677.191, 1693.059, 1709.156, 1725.857, 1742.607, 1759.841, 1777.081, 1794.777, 1812.676, 1831.09, 1849.845, 1869.087, 1888.793, 1908.919, 1929.578, 1950.513, 1972.046, 1993.844, 2016.392, 2039.145, 2062.89, 2086.72, 2111.316, 2135.759, 2161.281, 2186.715, 2213.542, 2240.311, 2268.741, 2297.16, 2327.352, 2357.255, 2389.361, 2421.594, 2460.463, 2500.658, 2539.411, 2572.713, 2599.666]
                fe =  [1501.946, 1512.242, 1526.7, 1544.055, 1564.149, 1584.966, 1605.31, 1625.495, 1646.929, 1668.293, 1690.792, 1713.33, 1737.159, 1761.305, 1786.616, 1812.172, 1838.806, 1865.908, 1894.121, 1923.011, 1953.045, 1984.062, 2016.364, 2049.912, 2084.457, 2120.239, 2157.036, 2195.512, 2235.034, 2276.604, 2319.233, 2364.296, 2410.409, 2459.431, 2509.437, 2562.874, 2617.546, 2677.823, 2738.868, 2802.6, 2862.179, 2914.164, 2954.436, 2983.047, 2998.761, 3005.309, 3004.269, 3002.377, 2998.996, 2999.011]
                kcl =  [670.062, 673.97, 679.324, 685.649, 692.966, 700.522, 707.78, 714.879, 722.414, 729.915, 737.793, 745.596, 753.736, 761.953, 770.646, 779.437, 788.515, 797.671, 807.149, 816.749, 826.548, 836.48, 846.714, 857.273, 868.132, 879.378, 890.872, 902.746, 914.836, 927.478, 940.323, 953.769, 967.405, 981.752, 996.258, 1011.629, 1027.101, 1043.512, 1060.023, 1077.603, 1095.176, 1113.981, 1132.746, 1152.917, 1173.043, 1196.564, 1220.365, 1242.897, 1261.867, 1276.893]
                mg2sio4 =  [1695.727, 1705.743, 1719.844, 1736.78, 1756.345, 1776.561, 1796.235, 1815.673, 1836.288, 1856.799, 1878.311, 1899.746, 1922.222, 1944.754, 1968.283, 1992.008, 2016.626, 2041.531, 2067.398, 2093.778, 2121.007, 2148.847, 2177.501, 2206.986, 2237.295, 2268.654, 2300.702, 2333.923, 2367.794, 2403.135, 2439.023, 2476.559, 2514.464, 2554.078, 2593.881, 2635.778, 2677.928, 2723.047, 2768.47, 2816.309, 2863.766, 2914.367, 2964.564, 3018.16, 3071.19, 3132.28, 3193.687, 3251.822, 3300.426, 3338.432]
                mns =  [1280.282, 1288.302, 1299.503, 1312.884, 1328.255, 1344.061, 1359.433, 1374.652, 1390.741, 1406.636, 1423.237, 1439.697, 1456.842, 1473.901, 1491.53, 1509.128, 1527.353, 1545.696, 1564.538, 1583.547, 1603.004, 1622.688, 1642.936, 1663.832, 1685.121, 1706.683, 1726.716, 1743.625, 1756.47, 1764.573, 1769.838, 1775.594, 1783.384, 1795.91, 1813.332, 1837.136, 1864.296, 1894.408, 1924.785, 1955.707, 1986.826, 2020.325, 2053.795, 2089.615, 2125.467, 2168.365, 2212.434, 2254.572, 2290.583, 2319.594]
                na2s =  [913.263, 919.009, 927.074, 936.734, 947.837, 959.272, 970.447, 981.5, 993.067, 1004.505, 1016.658, 1028.881, 1041.713, 1054.576, 1067.958, 1081.441, 1095.514, 1109.783, 1124.525, 1139.559, 1155.206, 1171.311, 1187.909, 1204.976, 1222.501, 1240.649, 1259.224, 1278.488, 1298.155, 1318.738, 1339.743, 1361.846, 1384.309, 1408.0, 1431.982, 1457.329, 1482.775, 1509.642, 1536.474, 1564.87, 1593.019, 1622.715, 1651.864, 1682.597, 1712.489, 1745.748, 1778.209, 1808.215, 1832.834, 1852.099]
                ni =  [1424.665, 1433.321, 1445.481, 1460.05, 1476.842, 1494.154, 1510.989, 1527.616, 1545.207, 1562.681, 1581.073, 1599.459, 1618.788, 1638.206, 1658.455, 1678.835, 1700.006, 1721.446, 1743.668, 1766.316, 1789.801, 1813.972, 1838.993, 1864.846, 1891.463, 1919.051, 1947.319, 1976.672, 2006.649, 2038.051, 2070.112, 2103.808, 2138.071, 2174.277, 2211.042, 2250.138, 2289.719, 2331.928, 2374.612, 2420.479, 2466.707, 2516.405, 2566.356, 2620.522, 2674.966, 2739.169, 2804.558, 2866.622, 2919.191, 2961.105]
                sio2 =  [1588.42, 1596.918, 1608.833, 1623.105, 1639.616, 1656.698, 1673.367, 1689.824, 1707.102, 1724.166, 1742.04, 1759.767, 1778.235, 1796.684, 1815.925, 1835.293, 1855.502, 1876.044, 1897.333, 1918.971, 1941.219, 1963.83, 1986.942, 2010.524, 2034.546, 2059.237, 2084.456, 2110.62, 2137.242, 2164.916, 2192.945, 2222.24, 2251.779, 2282.565, 2313.456, 2346.025, 2378.757, 2413.452, 2448.258, 2485.39, 2522.643, 2562.603, 2602.461, 2645.164, 2687.705, 2737.486, 2787.873, 2835.545, 2875.773, 2907.801]
                catio3 =  [1878.949, 1889.406, 1904.021, 1921.498, 1941.641, 1962.412, 1982.51, 2002.248, 2027.215, 2054.498, 2071.984, 2075.332, 2069.744, 2058.384, 2046.366, 2036.972, 2035.001, 2043.967, 2068.57, 2101.867, 2131.835, 2159.516, 2187.982, 2217.226, 2247.233, 2278.221, 2309.911, 2342.825, 2376.379, 2411.376, 2446.952, 2484.188, 2521.774, 2561.004, 2600.369, 2641.767, 2684.445, 2736.391, 2787.618, 2822.44, 2841.857, 2851.693, 2853.831, 2859.278, 2867.771, 2884.337, 2909.799, 2946.68, 2978.821, 2994.89]
                vo =  [1380.633, 1387.969, 1398.145, 1410.233, 1424.109, 1438.359, 1452.146, 1465.706, 1479.985, 1494.118, 1509.034, 1523.906, 1539.407, 1554.893, 1571.057, 1587.34, 1604.218, 1621.22, 1638.769, 1656.614, 1675.033, 1693.827, 1713.074, 1732.743, 1752.853, 1773.558, 1794.619, 1816.381, 1838.492, 1861.425, 1884.595, 1908.731, 1933.088, 1958.718, 1984.61, 2011.944, 2039.414, 2068.463, 2097.459, 2128.136, 2158.622, 2190.746, 2222.637, 2257.425, 2292.503, 2334.206, 2376.939, 2417.811, 2452.648, 2480.623]
                zns =  [800.763, 804.592, 809.913, 816.254, 823.635, 831.303, 838.72, 845.941, 853.465, 860.92, 868.816, 876.656, 884.797, 892.952, 901.491, 910.031, 918.758, 927.479, 936.457, 945.53, 954.837, 964.317, 974.061, 984.046, 994.28, 1004.886, 1015.709, 1026.853, 1038.162, 1049.942, 1061.937, 1074.577, 1087.409, 1100.88, 1114.558, 1129.166, 1143.935, 1159.611, 1175.481, 1192.905, 1210.642, 1230.244, 1249.322, 1266.625, 1280.679, 1291.323, 1297.8, 1301.014, 1301.203, 1300.468]
            else:
                print("Error in setting condensation curves")            
            
            
            
            press_con, old_kcl, old_zns, old_na2s, old_mns, old_cr, old_sio2, old_mg2sio4, old_vo, old_ni, old_fe, old_ca2sio4, old_catio3, old_al2o3, old_mgsio3 = np.loadtxt(condensation_data, unpack=True)
            
            press_con = [1e-05, 1.39e-05, 1.93e-05, 2.68e-05, 3.73e-05, 5.18e-05, 7.2e-05, 0.0001, 0.0001389, 0.0001931, 0.0002683, 0.0003728, 0.0005179, 0.0007197, 0.001, 0.0013895, 0.0019307, 0.0026827, 0.0037276, 0.0051795, 0.0071969, 0.01, 0.013895, 0.019307, 0.026827, 0.0372759, 0.0517947, 0.0719686, 0.1, 0.1389495, 0.1930698, 0.2682696, 0.3727594, 0.5179475, 0.7196857, 1.0, 1.3894955, 1.9306977, 2.6826958, 3.7275937, 5.1794747, 7.1968567, 10.0, 13.8949549, 19.3069773, 26.826958, 37.2759372, 51.7947468, 71.9685673, 100.0]

            # KCl, cr, sio2, Mg$_2$SiO$_4$, VO, Ni, Ca$_2$SiO$_4$, CaTiO$_3$, Al$_2$O$_3$
            new_pressures = np.logspace(-5, 2, 200)
    

            f_kcl = interp1d(press_con, kcl, fill_value='extrapolate')
            f_zns = interp1d(press_con, zns, fill_value='extrapolate')
            f_na2s = interp1d(press_con, na2s, fill_value='extrapolate')
            f_mns = interp1d(press_con, mns, fill_value='extrapolate')
            f_cr = interp1d(press_con, cr, fill_value='extrapolate')
            f_sio2 = interp1d(press_con, sio2, fill_value='extrapolate')
            f_mg2sio4 = interp1d(press_con, mg2sio4, fill_value='extrapolate')
            f_vo = interp1d(press_con, vo, fill_value='extrapolate')
            f_ni = interp1d(press_con, ni, fill_value='extrapolate')
            f_fe = interp1d(press_con, fe, fill_value='extrapolate')
            f_ca2sio4 = interp1d(press_con, ca2sio4, fill_value='extrapolate')
            f_catio3 = interp1d(press_con, catio3, fill_value='extrapolate')
            f_al2o3 = interp1d(press_con, al2o3, fill_value='extrapolate')

            cloud_colors = pl.cm.gnuplot(np.linspace(0, 1, 13))
            cloud_colors = pl.cm.nipy_spectral(np.linspace(0, 1, 13))

            #colors = ['#e6194B', '#3cb44b', '#ffe119', '#4363d8', '#f58231', '#911eb4', '#42d4f4',
            #          '#f032e6', '#bfef45', '#fabed4', '#469990', '#dcbeff', '#9A6324', '#fffac8',
            #          '#800000', '#aaffc3', '#808000', '#ffd8b1', '#000075', '#a9a9a9', '#ffffff']

            axes.semilogy(f_kcl(new_pressures), new_pressures, lw=2, label='KCl', color='#03719c', linestyle='dotted')
            #axes.semilogy(f_cr(new_pressures), new_pressures, lw=2, label='Cr', color=cloud_colors[1])
            #axes.semilogy(f_sio2(new_pressures), new_pressures, lw=2, label=r'SiO$_2$', color=cloud_colors[2])
            #axes.semilogy(f_mg2sio4(new_pressures), new_pressures, lw=2, label=r'Mg$_2$SiO$_4$', color=cloud_colors[3])
            #axes.semilogy(f_vo(new_pressures), new_pressures, lw=2, label='VO', color=cloud_colors[4])
            #axes.semilogy(f_ca2sio4(new_pressures), new_pressures, lw=2, label=r'Ca$_2$SiO$_4$', color=cloud_colors[5])
            #axes.semilogy(f_catio3(new_pressures), new_pressures, lw=2, label=r'CaTiO$_3$', color=cloud_colors[6])
            #axes.semilogy(f_al2o3(new_pressures), new_pressures, lw=2, label=r'Al$_2$O$_3$', color=cloud_colors[7])

            if not nucleation_lim:
                axes.semilogy(f_fe(new_pressures), new_pressures, lw=2, label=r'Fe', color=cloud_colors[8])
                axes.semilogy(f_na2s(new_pressures), new_pressures, lw=2, label=r'Na$_2$S', color=cloud_colors[9])
                axes.semilogy(f_mns(new_pressures), new_pressures, lw=2, label=r'mns', color=cloud_colors[10])
                axes.semilogy(f_zns(new_pressures), new_pressures, lw=2, label=r'ZnS', color=cloud_colors[11])
                axes.semilogy(f_ni(new_pressures), new_pressures, lw=2, label=r'Ni', color=cloud_colors[12])

            axes.legend(fontsize=14, ncol=2, labelspacing=0.0, loc='lower left')

        axes.set_ylim(np.max(data[24][0][:, 4]), np.min(data[24][0][:, 4]))
        axes.set_xlim([150, 1125])

        axes.xaxis.set_ticks_position('bottom')
        axes.xaxis.set_label_position('bottom')

        axes.minorticks_on()  # This enables minor ticks


        # tp labels
        axes.set_ylabel('Pressure (bars)', fontsize=24)

        # colorbars
        sm = plt.cm.ScalarMappable(cmap=my_colors, norm=plt.Normalize(vmin=-180, vmax=180))
        sm._A = []
        tp_cbar = fig.colorbar(sm, aspect=15, pad=0.02, ticks=[0, -60, -120, 60, 120])
        tp_cbar.set_label('Lon (deg)', fontsize=24, labelpad=5)


        fig.text(0.5, 0.03, r"Temperature (K)", size=24, ha='center')

        print('Creating plot DONE')

        fig.savefig('../Figures/PTC_Curves_{}.png'.format(planet_name), bbox_inches='tight', dpi=250)
